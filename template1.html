
<!DOCTYPE html>
<html lang="en">

<html>

	<head>

		<title>Bootstrap Example</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
	  <!DOCTYPE html>
	</head>  

<body>
	<script>
		window.sessionStorage
	  </script>

	<div>
		
	
           <head>
			<style>
				.test100 {
  				visibility: hidden;
				}

				</style>   
			</head>
			
			<iframe class = "" id="upload_target" name="upload_target"  style="width:0;height:0;border:0px solid #fff;"></iframe> 	


			<div id = "{{.MainDivID}}">

			


			<div id = "">zzzz</div>
			<div id  = "" class = "test100_" Value = "" name = "">  
			
			
			
			<div class="row" > 
			<div class="col">
			 <p id = "">product id   : {{.ProductID}} </p>" 
			<p>category id  : {{.ProductCatTitle}}</p>


		

      <form target = "upload_target"  enctype="multipart/form-data" method = "POST" action="/updateForm/?idproducts={{.ProductID}}">
			<h4><center><p id = "">Image</p></center></h4>


			<center><img  height="100" width="100"  src= "/golangproj/uploads/{{.ProductFilename}}" alt="no product image"></center> 

			</div>

			<div class="col">
			<h4><center><p id =""  >Title</p></center></h4>

			<center><p><input id = "{{.TitleID}}" value = "{{.ProductName}}" type="text" name="title" placeholder="" readonly></p></center>
			</div>

			<div class="col">

			<h4><center><p id = "">Desc</p></center></h4>

			<center><textarea wrap id = "{{.DescID}}"   value = "{{.ProductDescription}}"  type="text" rows="5" cols="34" readonly></textarea></center>
			</div>

			<div class="col">" 
			<h4><center><p id = "" >Cost</p></center></h4>
			<center><p>	<input id = "{{.CostID}}" value =    {{.ProductCost}}     type="number" name="title" placeholder="" readonly>		</p></center>
		
			</div>
			</div>
			<div class="row">
			<div class="col">
			
			<h4><center><p id = "" >Quantity</p></center></h4>
			<center><p> <input id = "{{.QuantityID}}" value =  {{.ProductQuantity}}  type="number" name="title" placeholder="" readonly>	</p></center>
			</div>
			
			<div class="col">

			
				
			<h4><center><p id = "" >Keyword 1</p></center></h4>
			<center><p>	<input id = "{{.Key1ID}}" value = "{{.GKeyword1}}" type="text" name="title" placeholder="" readonly>		</p></center>

			</div>

			<div class="col">
			<h4><center><p id = "" >Keyword 2</p></center></h4>
			<center><p>	<input id = "{{.Key2ID}}" value = "{{.GKeyword2}}" type="text" name="title" placeholder="" readonly>		</p></center>

			</div>

			<div class="col">
			<h4><center><p id = "" >Keyword 3</p></center></h4>
			<center><p>	<input id =   "{{.Key3ID}}"  value = "{{.GKeyword3}}" type="text" name="{{.Key3ID}}" placeholder="" readonly> 	</p></center>
			</div>
			</div>
			<div class="row">
			<div class="col">
			
			<h4><center><p id = "" >Amount purchased</p></center></h4>
			<center><p><input id = "{{.AmountPurchasedID}}" value = 0 type="number" name="title" placeholder="" readonly ></p></center>

			<h4><center><p id = "" >Amount to purchase</p></center></h4>
			<center><p><input id = "{{.AmountToPurchaseID}}" value = 0 type="number" name="title" placeholder="" ></p></center>
			</div>
		    </div>
			<div class="row">
			<div class="col">
			<center><button onclick="removeRecord('{{.MainDivID}}' )">Remove Record</button></center>
			<center><button onclick="changeFields('{{.ProductQuantity}}', '{{.ProductID}}' , '{{.QuantityID}}', '{{.AmountPurchasedID}}', '{{.AmountToPurchaseID}}' )">submit</button></center>
			</div>
			</div>
			</div>
		    </div>
			</div>
			
			
			<script>
			 var gAccount = [];
			 //var originalQuantity = "{{.ProductQuantity}}";

			function removeRecord(mainDivForRecord)
			{
				alert("hereisit");
				document.getElementById(mainDivForRecord).innerHTML = "";
			}
			//called on 
            var gTotalOfPurchases = 0;
			function changeFields(originalQuantity, productID, quantityID, amountPurchasedID, amountToPurchaseID)
			{
				

				//console.log("test");
				//console.log("{{.Key3ID}}");
				//console.log(document.getElementById("{{.Key3ID}}"));
				//var elem = document.getElementById("{{.Key3ID}}");
				//console.log(elem);
				//elem.value = "block";


				//alert(quantityID);

				var amountToBePurchased  = 0;
				var  amountInPurchasedField = 0;
				var amountPurchasedSoFar = 0;
				var value1 = 0;
				var value2 = 0;
				//total of product with server
				amountInPurchasedField = document.getElementById(quantityID).value;
				//already purchased
				amountPurchasedSoFar = document.getElementById(amountPurchasedID).value;
				//amount held for subtraction when submit button pressed
				amountToBePurchased = document.getElementById(amountToPurchaseID).value;

				
				//alert(amountToBePurchased);
				//document.getElementById(amountPurchasedID).value="";

				
				//if there is enough product go in here - take from dbase amount
				if((parseInt(amountInPurchasedField) >= parseInt(amountToBePurchased)) && parseInt(amountToBePurchased) > 0  )
				{

					
					
					value1 = document.getElementById(amountToPurchaseID).value; 
					value2  = parseInt(value1) + parseInt(amountPurchasedSoFar);
					
					//puts total in here
					document.getElementById(amountPurchasedID).value = value2 ;
					document.getElementById(quantityID).value = amountInPurchasedField - amountToBePurchased ;
					gTotalOfPurchases =  parseInt(gTotalOfPurchases) +  parseInt(amountToBePurchased); 
                    if(gTotalOfPurchases > 0){
                        document.getElementById(amountToPurchaseID).value = 0;
                        alert("here");
						alert(amountToBePurchased);
						saveData(productID, amountToBePurchased)
                        return (1);
                    }

					///////////




					///////////



				}
				//adding to quantity
				else if( (parseInt(amountToBePurchased) < 0  ) && ((-1*(parseInt(amountToBePurchased)) + parseInt(amountInPurchasedField ) <= originalQuantity))){

					alert(amountToBePurchased);
					alert(amountInPurchasedField);
					alert(originalQuantity);
					//alert("a");
					//in field not submitted yet
					value1 = document.getElementById(amountToPurchaseID).value; 
					//total of amount for text box
					value2  = parseInt(amountInPurchasedField) - parseInt(value1);
					alert(value2);
					//change total in here
					document.getElementById(quantityID).value = value2 ;
					//amount purchaesd  subtracks amounttopurchase 
					document.getElementById(amountPurchasedID).value = parseInt(amountPurchasedSoFar) + parseInt(amountToBePurchased);

				}
				
				
				document.getElementById(amountToPurchaseID).value = 0;

								
			}

           var gCounter = -1;

		   //CHANGEFILEDs*******
			//https://stackoverflow.com/questions/17309199/how-to-send-variables-from-one-file-to-another-in-javascript/17309679#17309679
			//https://www.w3docs.com/learn-javascript/localstorage-sessionstorage.html
			function  saveData(productID, quantityTryingToBuy)
			{
				//alert(productID)
				//alert(quantityTryingToBuy)
				gCounter++;
				var sessionID = "_" + gCounter;
				//alert(sessionID);
                var account = {
    			ID: productID ,
     			Quant: quantityTryingToBuy
   				};
				   //alert("makeit?");
				   console.log(account)
				//converts to JSON string the Object
				//account = JSON.stringify(account);
				//creates a base-64 encoded ASCII string
				//account = btoa(account);
				//save the encoded accout to web storage
				//localStorage.setItem('_account', account);
				//   console.log(account)
				//alert(account.ID);
				//alert(account.Quant);

				//Last productID writes over the first
                sessionStorage.setItem(account.ID, account.Quant);
				
                //alert(gAccount);

			}


			</script>

			
			</div>

			</div>
			
			</body>
			</html>
			
			<br><br><br><br><br>

			

            